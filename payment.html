<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Payment | Cozy Coffee</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins&display=swap" rel="stylesheet">
</head>
<body class="payment">

<div class="payment-box">
    <h2>Secure Payment</h2>
    <p>Total to pay: <strong>R{{ order.total_price }}</strong></p>

    <form method="POST">

        <label>Card Number</label>
        <input
            type="text"
            name="card_number"
            placeholder="1234 5678 9012 3456"
            maxlength="19"
            pattern="[0-9 ]{19}"
            required
        >

        <label>Expiry Date (MM/YY)</label>
        <input
            type="text"
            name="expiry"
            placeholder="MM/YY"
            maxlength="5"
            pattern="(0[1-9]|1[0-2])\/[0-9]{2}"
            required
        >

        <label>CVV</label>
        <input
            type="password"
            name="cvv"
            placeholder="123"
            maxlength="3"
            pattern="[0-9]{3}"
            required
        >

        <label>Email for Invoice</label>
        <input
            type="email"
            name="email"
            placeholder="you@email.com"
            required
        >

        <button type="submit" class="btn">Pay Now</button>
    </form>
</div>

<script>
// Auto-format card number (adds spaces)
document.querySelector("input[name='card_number']").addEventListener("input", function () {
    this.value = this.value.replace(/\D/g, '')
        .replace(/(.{4})/g, '$1 ')
        .trim();
});

// Auto-format expiry
document.querySelector("input[name='expiry']").addEventListener("input", function () {
    let v = this.value.replace(/\D/g, '');
    if (v.length >= 3) v = v.slice(0,2) + '/' + v.slice(2,4);
    this.value = v;
});
</script>

</body>
</html>
